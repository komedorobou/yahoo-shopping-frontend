<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yahoo Shopping 利益商品検索ツール</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- APIキー設定モーダル -->
    <div id="apiKeyModal" class="modal">
        <div class="modal-content">
            <h2>Yahoo Shopping API設定</h2>
            <p>Yahoo Shopping APIのアプリケーションIDを入力してください</p>
            <a href="https://e.developer.yahoo.co.jp/register" target="_blank" class="link">
                APIキーの取得方法はこちら
            </a>
            <input type="text" id="apiKeyInput" placeholder="dj00aiZpPXXXXXXXXXXX..." />
            <button id="saveApiKey">保存して開始</button>
            <p class="note">※ブラウザのLocalStorageに保存されます（サーバーには送信されません）</p>
        </div>
    </div>

    <!-- メインコンテンツ -->
    <div id="mainContent" style="display: none;">
        <header>
            <h1>Yahoo Shopping 利益商品検索</h1>
            <button id="settingsBtn" class="settings-btn">⚙️ 設定</button>
        </header>

        <main>
            <!-- CSV アップロード -->
            <section class="upload-section">
                <h2>1. CSVファイルをアップロード</h2>
                <p class="instruction">A列:ブランド名、B列:商品名、D列:最頻値価格</p>
                <input type="file" id="csvFile" accept=".csv" />
                <div id="csvStatus" class="status"></div>
            </section>

            <!-- 検索設定 -->
            <section class="settings-section">
                <h2>2. 検索条件</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>最低利益率 (%)</label>
                        <input type="number" id="minProfitMargin" value="40" min="0" max="100" />
                    </div>
                    <div class="setting-item">
                        <label>最大検索件数 (行)</label>
                        <input type="number" id="maxSearchItems" value="20" min="1" max="100" />
                    </div>
                    <div class="setting-item">
                        <label>1商品あたりの結果数</label>
                        <input type="number" id="resultsPerItem" value="5" min="1" max="10" />
                    </div>
                </div>
                <button id="startSearch" class="primary-btn" disabled>検索開始</button>
            </section>

            <!-- 進捗表示 -->
            <section id="progressSection" class="progress-section" style="display: none;">
                <h2>検索中...</h2>
                <div class="progress-bar">
                    <div id="progressBar" class="progress-fill"></div>
                </div>
                <p id="progressText">0 / 0</p>
            </section>

            <!-- 検索結果 -->
            <section id="resultsSection" class="results-section" style="display: none;">
                <h2>利益商品発見</h2>
                <div id="resultsStats" class="stats"></div>
                <div id="resultsContainer" class="results-grid"></div>
                <button id="exportResults" class="export-btn">CSVエクスポート</button>
            </section>
        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>
